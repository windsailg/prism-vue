(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2054f932"],{"498a":function(e,t,a){"use strict";var n=a("23e7"),r=a("58a8").trim,s=a("c8d2");n({target:"String",proto:!0,forced:s("trim")},{trim:function(){return r(this)}})},5652:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mb-5"},[a("h1",[e._v("類別管理")]),a("Spinner",{class:{"fade-out":!e.isLoading}}),a("BackStageNav"),a("CategoriesTable",{attrs:{categories:e.categories,"is-processing":e.isProcessing},on:{"after-submit":e.handleAfterSubmit,"after-toggle":e.handleAfterToggle,"after-cancel":e.handleAfterCancel,"after-update":e.handleAfterUpdate,"after-delete":e.handleAfterDelete}})],1)},r=[],s=a("5530"),i=a("1da1"),o=(a("96cf"),a("d81d"),a("498a"),a("b0c0"),a("4de4"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row justify-content-end mt-3 mb-3"},[a("form",{staticClass:"input-group mb-3",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.handleSubmit(t)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newCategoryName,expression:"newCategoryName"}],staticClass:"form-control",attrs:{type:"text","aria-label":"Recipient's username","aria-describedby":"button-addon2",placeholder:"新增分類名稱",name:"name"},domProps:{value:e.newCategoryName},on:{input:function(t){t.target.composing||(e.newCategoryName=t.target.value)}}}),a("button",{staticClass:"btn btn-primary shadow-sm",attrs:{type:"submit",disabled:e.isProcessing}},[a("i",{staticClass:"fas fa-file mr-1"}),e._v(" 新增分類 ")])])]),a("div",{staticClass:"row shadow card"},[a("table",{staticClass:"table mb-0"},[e._m(0),a("tbody",{},e._l(e.categories,(function(t){return a("tr",{key:t.id},[a("th",{staticClass:"text-center",attrs:{scope:"row"}},[e._v(e._s(t.id))]),a("td",[a("h5",{directives:[{name:"show",rawName:"v-show",value:!t.isEditing,expression:"!category.isEditing"}],staticClass:"m-0"},[e._v(" "+e._s(t.name)+" ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"category.isEditing"}],staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"category.name"}],staticClass:"form-control",attrs:{type:"text","aria-label":"Recipient's categoryName","aria-describedby":"button-addon2",placeholder:"輸入更改的分類名稱",name:"name"},domProps:{value:t.name},on:{input:function(a){a.target.composing||e.$set(t,"name",a.target.value)}}}),a("button",{staticClass:"btn btn-sm btn-warning p-2 cancel",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.handleCancel(t.id)}}},[e._v(" 取消 ")])])]),a("td",{staticClass:"text-center"},[a("button",{directives:[{name:"show",rawName:"v-show",value:!t.isEditing,expression:"!category.isEditing"}],staticClass:"btn btn-primary btn-sm mr-1",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.handleToggle(t.id)}}},[a("i",{staticClass:"fas fa-pencil-alt"})]),a("button",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"category.isEditing"}],staticClass:"btn btn-success btn-sm mr-1",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.handleUpdate({id:t.id,name:t.name})}}},[a("i",{staticClass:"fas fa-save"})]),a("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"submit",disabled:e.isProcessing},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.handleDelete(t.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})])])])})),0)])])])}),c=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",{staticClass:"table-secondary"},[a("tr",[a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v("id")]),a("th",{attrs:{scope:"col"}},[e._v("Category Name")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v("操作")])])])}],l={name:"CategoriesTable",props:{categories:{type:Array,required:!0},isProcessing:{type:Boolean,default:!1}},data:function(){return{newCategoryName:""}},methods:{handleSubmit:function(){this.$emit("after-submit",this.newCategoryName)},handleToggle:function(e){this.$emit("after-toggle",e)},handleCancel:function(e){this.$emit("after-cancel",e)},handleUpdate:function(e){this.$emit("after-update",e)},handleDelete:function(e){this.$emit("after-delete",e)}},created:function(){}},u=l,d=a("2877"),m=Object(d["a"])(u,o,c,!1,null,null,null),g=m.exports,f=a("c81a"),p=a("ee21"),h=a("2375"),v=a("2fa3"),b={name:"AdminCategories",components:{CategoriesTable:g,BackStageNav:f["a"],Spinner:h["a"]},data:function(){return{categories:[],isProcessing:!1,isLoading:!0}},methods:{fetchData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,p["a"].categories.get();case 4:a=t.sent,n=a.data,e.categories=n.categories.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{isEditing:!1,nameCatched:""})})),e.isLoading=!1,t.next=16;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0),e.isProcessing=!1,e.isLoading=!1,e.toastFire("error","取得資料失敗，請稍後再試");case 16:case"end":return t.stop()}}),t,null,[[0,10]])})))()},handleAfterSubmit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,e.trim()){a.next=3;break}return a.abrupt("return",t.toastFire("error","分類名稱不得為空"));case 3:return t.isProcessing=!0,a.next=6,p["a"].categories.create({name:e});case 6:if(n=a.sent,r=n.data,"success"===r.status){a.next=10;break}throw new Error(r.message);case 10:t.toastFire("success","新增分類成功"),t.fetchData(),t.isProcessing=!1,a.next=20;break;case 15:a.prev=15,a.t0=a["catch"](0),console.log(a.t0),t.isProcessing=!1,t.toastFire("error",a.t0||"新增分類失敗，請稍後再試");case 20:case"end":return a.stop()}}),a,null,[[0,15]])})))()},handleAfterToggle:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(s["a"])(Object(s["a"])({},t),{},{isEditing:!t.isEditing,nameCatched:t.name}):t}))},handleAfterCancel:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(s["a"])(Object(s["a"])({},t),{},{name:t.nameCatched,isEditing:!1}):t}))},handleAfterUpdate:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,e.name.trim()){a.next=4;break}return t.toastFire("error","分類名稱不得為空"),a.abrupt("return");case 4:return t.isProcessing=!0,a.next=7,p["a"].categories.update({id:e.id,name:e.name});case 7:if(n=a.sent,r=n.data,"success"===r.status){a.next=11;break}throw new Error(r.message);case 11:t.toastFire("success","修改分類成功"),t.categories=t.categories.map((function(t){return t.id===e.id?Object(s["a"])(Object(s["a"])({},t),{},{isEditing:!1}):t})),t.isProcessing=!1,a.next=21;break;case 16:a.prev=16,a.t0=a["catch"](0),console.log(a.t0),t.isProcessing=!1,t.toastFire("error",a.t0||"修改分類失敗，請稍後再試");case 21:case"end":return a.stop()}}),a,null,[[0,16]])})))()},handleAfterDelete:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.isProcessing=!0,a.next=4,p["a"].categories.delete({id:e});case 4:if(n=a.sent,r=n.data,"success"===r.status){a.next=8;break}throw new Error(r.message);case 8:t.toastFire("success","刪除分類成功"),t.categories=t.categories.filter((function(t){return t.id!==e})),t.isProcessing=!1,a.next=18;break;case 13:a.prev=13,a.t0=a["catch"](0),console.log(a.t0),t.isProcessing=!1,t.toastFire("error",a.t0||"刪除分類失敗，請稍後再試");case 18:case"end":return a.stop()}}),a,null,[[0,13]])})))()},toastFire:function(e,t){v["a"].fire({icon:e,title:t,background:"#eee",showConfirmButton:!1})}},created:function(){this.fetchData()}},w=b,C=Object(d["a"])(w,n,r,!1,null,null,null);t["default"]=C.exports},c81a:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container pt-3 pb-4 pr-0 pl-0"},[a("ul",{staticClass:"row mt-4 mb-3 nav nav-pills"},[a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"adminProducts"}}},[e._v("所有商品")])],1),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"adminCategories"}}},[e._v("分類列表")])],1),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"adminUsers"}}},[e._v("會員列表")])],1)])])},r=[],s={name:"BackStageNav",props:{}},i=s,o=a("2877"),c=Object(o["a"])(i,n,r,!1,null,null,null);t["a"]=c.exports},c8d2:function(e,t,a){var n=a("d039"),r=a("5899"),s="​᠎";e.exports=function(e){return n((function(){return!!r[e]()||s[e]()!=s||r[e].name!==e}))}},d81d:function(e,t,a){"use strict";var n=a("23e7"),r=a("b727").map,s=a("1dde"),i=s("map");n({target:"Array",proto:!0,forced:!i},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-2054f932.201b6b06.js.map